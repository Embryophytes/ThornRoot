name: Push crates to crates.io

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
    Push-crates:
        runs-on: ubuntu-latest

        steps:
            - uses: actions/checkout@v3
            - uses: actions-rs/toolchain@v1
              with:
                  toolchain: stable
                  override: true
            - uses: katyo/publish-crates@v2
              with:
                  dry-run: ${{ github.event_name != 'push' }}